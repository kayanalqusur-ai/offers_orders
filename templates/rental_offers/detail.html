{% extends "base.html" %}

{% block title %}تفاصيل عرض الإيجار - {{ district_name }}{% endblock %}

{% block content %}
<div class="card">
  <div class="card-header bg-dark text-white">
    <h3><i class="fas fa-key"></i> تفاصيل عرض الإيجار</h3> 
  </div>
  <div class="card-body">
    <p><strong>نوع الوحدة:</strong> {{ offer.unit_type }}</p>
    <p><strong>المساحة:</strong> {{ offer.area or '-' }} م²</p>
    <p><strong>الطابق:</strong> {{ offer.floor or '-' }}</p>
    <p><strong>السعر:</strong> {{ offer.price | price }} ريال</p>
    <p><strong>الموقع:</strong>
      {% if offer.location %}
        <a href="{{ offer.location }}" target="_blank">{{ offer.location }}</a>
      {% else %}
        -
      {% endif %}
    </p>

    <p><strong>التفاصيل:</strong> {{ offer.details or '-' }}</p>
    <p><strong>المسوق:</strong> {{ offer.marketer or '-' }}</p>
    <p><strong>صفة المالك:</strong> {{ offer.owner_type or '-' }}</p>
    <p><strong>الحالة:</strong> 
      {% if offer.status == 'متاح' %}
        <span class="badge bg-success">{{ offer.status }}</span>
      {% elif offer.status == 'عربون' %}
        <span class="badge bg-warning text-dark">{{ offer.status }}</span>
      {% else %}
        <span class="badge bg-secondary">{{ offer.status }}</span>
      {% endif %}
    </p>
    <p><strong>تاريخ الإنشاء:</strong> {{ offer.created_at.strftime('%Y-%m-%d') }}</p>

    {% if offer.notes %}
      <p><strong>ملاحظات:</strong> {{ offer.notes }}</p>
    {% endif %}

      {% if offer.images and offer.images|length > 0 %}
  <div class="mt-3">
    <h5>الصور:</h5>
    <div class="d-flex flex-wrap">
     {% for img in offer.images %}
  {% if img %}
    <div class="me-2 mb-2">
      <!-- الصورة المصغرة -->
      <img src="{{ img.thumbnail_url }}" class="img-thumbnail" style="width:150px;height:150px;cursor:pointer;"
           data-bs-toggle="modal" data-bs-target="#imageModal{{ loop.index }}">

      <!-- النافذة المنبثقة -->
      <div class="modal fade" id="imageModal{{ loop.index }}" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content">
            <div class="modal-body text-center">
              <img src="{{ img.original_url }}" class="img-fluid" alt="صورة العقار">
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
{% endfor %}

    </div>
  </div>
{% endif %}

  
  </div>
  <div class="card-footer">
    {% if district == 'وسط' %}
      <a href="{{ url_for('rentalm_offers') }}" class="btn btn-secondary">⬅ العودة لقائمة العروض</a>
    {% elif district == 'جنوب' %}
      <a href="{{ url_for('rentalw_offers') }}" class="btn btn-secondary">⬅ العودة لقائمة العروض</a>
    {% endif %}
  </div>
</div>
{% endblock %}
